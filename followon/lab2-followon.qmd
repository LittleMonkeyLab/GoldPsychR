---
title: "Lab 2 Follow-On: Transfer Practice"
subtitle: "Comparing Groups with New Data"
author: "YOUR NAME HERE"
date: today
format:
  html:
    toc: true
    toc-depth: 2
    number-sections: true
    code-fold: false
    code-annotations: below
    theme: cosmo
    embed-resources: true
---

```{r}
#| label: setup
#| message: false
#| warning: false

# Load required packages
library(readr)
library(dplyr)
library(ggplot2)
```

# Introduction

This follow-on exercise uses a **sleep and academic performance** dataset to help you consolidate your Lab 2 hypothesis testing skills.

::: {.callout-note}
## Dataset: Sleep & Performance Study

Researchers investigated whether sleep duration affects academic performance in university students.

- **Participants**: 80 students
- **Design**: Between-subjects comparison (adequate sleep vs sleep deprived)
- **Measure**: Exam score (0-100)
- **Hypothesis**: Students with adequate sleep will perform better
:::

# Task 1: Load and Explore

```{r}
#| label: load-data

# Load the sleep and performance data from GitHub
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/sleep_performance.csv"
sleep_data <- read_csv(data_url, show_col_types = FALSE)
```

```{r}
#| label: explore

# YOUR CODE: View the first few rows
head(sleep_data)

# YOUR CODE: Check the structure
str(sleep_data)

# YOUR CODE: Count participants in each group
table(sleep_data$sleep_group)
```

::: {.callout-note}
## Questions

1. How many students in each sleep group? **[YOUR ANSWER]**
2. What is the overall mean exam score? **[YOUR ANSWER]**
:::

# Task 2: Descriptive Statistics by Group

Calculate mean, SD, and n for each sleep group:

```{r}
#| label: descriptives

# YOUR CODE: Calculate descriptives for each sleep group
sleep_data |>
  group_by(sleep_group) |>
  summarise(
    n = n(),
    mean = mean(exam_score, na.rm = TRUE),
    sd = sd(exam_score, na.rm = TRUE),
    .groups = "drop"
  )
```

::: {.callout-note}
## Questions

1. What is the mean score for the adequate sleep group? **[YOUR ANSWER]**
2. What is the mean score for the sleep deprived group? **[YOUR ANSWER]**
3. Which group has more variability (higher SD)? **[YOUR ANSWER]**
:::

# Task 3: Visualisation

## Boxplot

```{r}
#| label: boxplot
#| fig-width: 8
#| fig-height: 5

# YOUR CODE: Create a boxplot of exam_score by sleep_group
ggplot(sleep_data, aes(x = sleep_group, y = exam_score, fill = sleep_group)) +
  geom_boxplot(alpha = 0.7) +
  theme_minimal() +
  labs(
    title = "Exam Scores by Sleep Group",
    x = "Sleep Group",
    y = "Exam Score"
  ) +
  theme(legend.position = "none")
```

## Add individual points

```{r}
#| label: boxplot-jitter
#| fig-width: 8
#| fig-height: 5

# YOUR CODE: Create a boxplot with jittered points overlaid
# Hint: Add geom_jitter(width = 0.1, alpha = 0.5)
ggplot(sleep_data, aes(x = sleep_group, y = exam_score, fill = sleep_group)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.1, alpha = 0.5) +
  theme_minimal() +
  labs(
    title = "Exam Scores by Sleep Group",
    x = "Sleep Group",
    y = "Exam Score"
  ) +
  theme(legend.position = "none")
```

# Task 4: Independent Samples t-test

Test whether exam scores differ between sleep groups:

```{r}
#| label: t-test

# YOUR CODE: Run an independent samples t-test
t.test(exam_score ~ sleep_group, data = sleep_data)
```

::: {.callout-note}
## Questions

1. What is the t-statistic? **[YOUR ANSWER]**
2. What are the degrees of freedom? **[YOUR ANSWER]**
3. What is the p-value? **[YOUR ANSWER]**
4. Is the difference statistically significant (p < .05)? **[YOUR ANSWER]**
:::

# Task 5: Effect Size

Calculate Cohen's d to measure the size of the effect:

```{r}
#| label: effect-size

# YOUR CODE: Calculate Cohen's d manually
# Hint: d = (mean1 - mean2) / pooled_sd

adequate <- sleep_data |> filter(sleep_group == "adequate") |> pull(exam_score)
deprived <- sleep_data |> filter(sleep_group == "deprived") |> pull(exam_score)

m1 <- mean(adequate)
m2 <- mean(deprived)
n1 <- length(adequate)
n2 <- length(deprived)

# Pooled SD
pooled_sd <- sqrt(((n1-1)*var(adequate) + (n2-1)*var(deprived)) / (n1+n2-2))

# Cohen's d
cohens_d <- (m1 - m2) / pooled_sd
cat("Cohen's d =", round(cohens_d, 3))
```

::: {.callout-tip}
## Interpreting Cohen's d

- d = 0.2: Small effect
- d = 0.5: Medium effect
- d = 0.8: Large effect
:::

::: {.callout-note}
## Questions

1. What is Cohen's d? **[YOUR ANSWER]**
2. How would you interpret this effect size? **[YOUR ANSWER]**
:::

# Task 6: Confidence Interval

Extract and interpret the 95% confidence interval:

```{r}
#| label: ci

# YOUR CODE: Run t.test and examine the confidence interval
result <- t.test(exam_score ~ sleep_group, data = sleep_data)
cat("95% Confidence Interval:\n")
cat("Lower:", round(result$conf.int[1], 2), "\n")
cat("Upper:", round(result$conf.int[2], 2))
```

::: {.callout-note}
## Questions

1. What is the 95% CI for the mean difference? **[YOUR ANSWER]**
2. Does the CI include zero? **[YOUR ANSWER]**
3. What does this tell us about statistical significance? **[YOUR ANSWER]**
:::

# Task 7: APA Write-Up

Write an APA-style results paragraph including:

- Descriptive statistics for each group
- t-test results (t, df, p)
- Effect size (Cohen's d)
- Confidence interval
- Brief interpretation

**YOUR WRITE-UP:**

[Write your paragraph here]

# Task 8: Comparison with Lab 2

::: {.callout-note}
## Reflection

Compare this analysis to the main Lab 2 exercise:

1. **What was similar about the two analyses?**

[YOUR ANSWER]

2. **What was different?**

[YOUR ANSWER]

3. **Which type of t-test did you use here, and why?**

[YOUR ANSWER]

4. **How confident do you feel running independent samples t-tests now?**

[YOUR ANSWER]
:::

# Solutions

::: {.callout-caution collapse="true"}
## Click to reveal solutions (try first!)

### Task 2: Descriptives
```r
sleep_data |>
  group_by(sleep_group) |>
  summarise(
    mean = mean(exam_score),
    sd = sd(exam_score),
    n = n()
  )
```

### Task 3: Boxplot with jitter
```r
ggplot(sleep_data, aes(x = sleep_group, y = exam_score, fill = sleep_group)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.1, alpha = 0.5) +
  theme_minimal() +
  labs(title = "Exam Scores by Sleep Group",
       x = "Sleep Group", y = "Exam Score")
```

### Task 4: t-test
```r
t.test(exam_score ~ sleep_group, data = sleep_data)
```

### Task 5: Cohen's d
```r
adequate <- sleep_data |> filter(sleep_group == "adequate") |> pull(exam_score)
deprived <- sleep_data |> filter(sleep_group == "deprived") |> pull(exam_score)

mean_diff <- mean(adequate) - mean(deprived)
pooled_sd <- sqrt((var(adequate) + var(deprived)) / 2)
cohens_d <- mean_diff / pooled_sd
cohens_d
```

### Task 7: APA Write-Up Example
> An independent samples t-test was conducted to compare exam scores between students with adequate sleep (*M* = 72.3, *SD* = 9.8) and sleep-deprived students (*M* = 63.7, *SD* = 11.5). There was a significant difference between groups, *t*(78) = 3.58, *p* < .001, *d* = 0.80, 95% CI [3.85, 13.42]. This represents a large effect, suggesting that adequate sleep is associated with meaningfully better exam performance.
:::

# Session Info

```{r}
#| label: session-info
sessionInfo()
```
