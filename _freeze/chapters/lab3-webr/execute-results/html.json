{
  "hash": "81fe4f42f48b9accf65c3052cf4cc939",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 3: ANOVA\"\nsubtitle: \"Interactive Practice with WebR\"\nauthor: \"Gordon Wright\"\nformat:\n  html:\n    toc: true\n    toc-depth: 2\n    number-sections: true\n    theme: cosmo\n    code-fold: false\nfilters:\n  - webr\nwebr:\n  packages: ['dplyr', 'ggplot2']\n  show-startup-message: false\n---\n\n\n::: {.cell}\n\n:::\n\n\n# Welcome\n\nThis interactive chapter lets you practice ANOVA directly in your browser.\n\n::: {.callout-tip}\n## How to Use This Page\n\n1. Read the explanations carefully\n2. Run the code cells by clicking the **Run** button\n3. Modify code and experiment\n4. Complete the self-check questions\n:::\n\n```{webr-r}\n#| context: setup\n#| autorun: true\n\n# Simulate experimental data with 3 groups\nset.seed(42)\nn <- 90\n\ntherapy_data <- data.frame(\n  participant = 1:n,\n  therapy = rep(c(\"CBT\", \"medication\", \"control\"), each = n/3),\n  anxiety = c(\n    rnorm(n/3, mean = 12, sd = 4),\n    rnorm(n/3, mean = 15, sd = 4),\n    rnorm(n/3, mean = 18, sd = 4)\n  )\n)\n\n# Factorial data (2x2)\nfactorial_data <- data.frame(\n  participant = 1:80,\n  therapy = rep(c(\"CBT\", \"control\"), each = 40),\n  duration = rep(rep(c(\"short\", \"long\"), each = 20), 2),\n  improvement = c(\n    rnorm(20, mean = 8, sd = 3),   # CBT short\n    rnorm(20, mean = 14, sd = 3),  # CBT long\n    rnorm(20, mean = 4, sd = 3),   # control short\n    rnorm(20, mean = 5, sd = 3)    # control long\n  )\n)\n```\n\n# When to Use ANOVA\n\n## t-test vs ANOVA\n\n- **t-test**: Compare **2** groups\n- **ANOVA**: Compare **3+** groups\n\nWhy not just run multiple t-tests?\n\n::: {.callout-warning}\n## Multiple Comparisons Problem\n\nRunning many t-tests inflates your Type I error rate. ANOVA controls this!\n:::\n\n::: {.callout-note}\n## Self-Check\n\nWhen should you use ANOVA instead of a t-test?\n\n<select class='webex-select'><option value='blank'></option><option value=''>Always</option><option value=''>When comparing 2 groups</option><option value='answer'>When comparing 3 or more groups</option></select>\n:::\n\n# One-Way ANOVA\n\n## The Data\n\n```{webr-r}\n#| autorun: true\n\n# View the therapy data\nhead(therapy_data)\n\n# Check group sizes\ntable(therapy_data$therapy)\n```\n\n## Running One-Way ANOVA\n\n```{webr-r}\n# Fit the ANOVA model\nmodel <- aov(anxiety ~ therapy, data = therapy_data)\n\n# View results\nsummary(model)\n```\n\n## Understanding the Output\n\nKey values:\n\n- **F value**: Ratio of between-group to within-group variance\n- **Pr(>F)**: p-value for the F-test\n- **Df**: Degrees of freedom (between groups, within groups)\n\n::: {.callout-note}\n## Self-Check\n\nA significant ANOVA tells us:\n\n<select class='webex-select'><option value='blank'></option><option value=''>Which groups differ</option><option value='answer'>At least one group differs from the others</option><option value=''>All groups are different</option></select>\n:::\n\n# Post-Hoc Tests\n\n## Why Post-Hoc Tests?\n\nANOVA tells us IF groups differ, but not WHICH groups differ.\n\n## Tukey's HSD\n\n```{webr-r}\n# Run Tukey's Honest Significant Difference\nTukeyHSD(model)\n```\n\n## Interpreting Post-Hoc Results\n\nLook for:\n\n- **diff**: Difference between means\n- **p adj**: Adjusted p-value\n- Confidence intervals that don't include 0\n\n::: {.callout-note}\n## Self-Check\n\nWhat does \"HSD\" stand for in Tukey's HSD?\n\n<select class='webex-select'><option value='blank'></option><option value=''>High Standard Deviation</option><option value='answer'>Honest Significant Difference</option><option value=''>Hypothesis Statistical Difference</option></select>\n:::\n\n# Effect Sizes\n\n## Eta-Squared (η²)\n\n```{webr-r}\n# Calculate eta-squared manually\nss_between <- sum(model$effects^2)\nss_total <- sum((therapy_data$anxiety - mean(therapy_data$anxiety))^2)\n\n# Get from summary\nmodel_summary <- summary(model)\nss_therapy <- model_summary[[1]][\"therapy\", \"Sum Sq\"]\nss_residual <- model_summary[[1]][\"Residuals\", \"Sum Sq\"]\n\neta_sq <- ss_therapy / (ss_therapy + ss_residual)\ncat(\"Eta-squared:\", round(eta_sq, 3))\n```\n\n## Interpreting Effect Sizes\n\n| η² value | Interpretation |\n|----------|----------------|\n| 0.01 | Small |\n| 0.06 | Medium |\n| 0.14 | Large |\n\n::: {.callout-note}\n## Self-Check\n\nAn eta-squared of 0.10 would be considered:\n\n<select class='webex-select'><option value='blank'></option><option value=''>Small</option><option value='answer'>Medium</option><option value=''>Large</option></select>\n:::\n\n# Visualisation\n\n## Boxplot by Group\n\n```{webr-r}\n#| fig-width: 8\n#| fig-height: 5\n\nlibrary(ggplot2)\n\nggplot(therapy_data, aes(x = therapy, y = anxiety, fill = therapy)) +\n  geom_boxplot(alpha = 0.7) +\n  theme_minimal() +\n  labs(title = \"Anxiety Scores by Therapy Type\",\n       x = \"Therapy\", y = \"Anxiety Score\")\n```\n\n## Bar Chart with Error Bars\n\n```{webr-r}\n#| fig-width: 8\n#| fig-height: 5\n\n# Calculate means and SEs\nsummary_data <- therapy_data |>\n  group_by(therapy) |>\n  summarise(\n    mean = mean(anxiety),\n    se = sd(anxiety) / sqrt(n())\n  )\n\nggplot(summary_data, aes(x = therapy, y = mean, fill = therapy)) +\n  geom_col(alpha = 0.7) +\n  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2) +\n  theme_minimal() +\n  labs(title = \"Mean Anxiety by Therapy\",\n       x = \"Therapy\", y = \"Mean Anxiety Score\")\n```\n\n# Two-Way ANOVA\n\n## Factorial Designs\n\nWhen you have two independent variables:\n\n```{webr-r}\n#| autorun: true\n\n# View factorial data\nhead(factorial_data)\n```\n\n## Running Two-Way ANOVA\n\n```{webr-r}\n# Fit factorial ANOVA\nfactorial_model <- aov(improvement ~ therapy * duration, data = factorial_data)\n\nsummary(factorial_model)\n```\n\n## Interpreting Results\n\nThe output shows:\n\n- Main effect of therapy\n- Main effect of duration\n- **Interaction** (therapy:duration)\n\n::: {.callout-note}\n## Self-Check\n\nWhat does a significant interaction mean?\n\n<select class='webex-select'><option value='blank'></option><option value=''>Both main effects are significant</option><option value='answer'>The effect of one IV depends on the level of the other</option><option value=''>There is no effect</option></select>\n:::\n\n## Visualising Interactions\n\n```{webr-r}\n#| fig-width: 8\n#| fig-height: 5\n\nggplot(factorial_data, aes(x = duration, y = improvement,\n                            colour = therapy, group = therapy)) +\n  stat_summary(fun = mean, geom = \"line\", size = 1) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  theme_minimal() +\n  labs(title = \"Interaction: Therapy x Duration\",\n       x = \"Duration\", y = \"Improvement\")\n```\n\n# APA Reporting\n\n## One-Way ANOVA\n\n> A one-way ANOVA revealed a significant effect of therapy type on anxiety scores, *F*(2, 87) = [F-value], *p* < .001, η² = [effect size].\n\n## With Post-Hoc\n\n> Post-hoc comparisons using Tukey's HSD indicated that CBT (M = [mean], SD = [sd]) resulted in significantly lower anxiety than control (M = [mean], SD = [sd]), p < .05.\n\n# Knowledge Check\n\n::: {.webex-check .webex-box}\n\n**1. What test should follow a significant ANOVA?**\n\n<select class='webex-select'><option value='blank'></option><option value=''>Another ANOVA</option><option value='answer'>Post-hoc tests</option><option value=''>Correlation</option></select>\n\n**2. True or False: ANOVA can only compare exactly 3 groups.**\n\n<select class='webex-select'><option value='blank'></option><option value=''>TRUE</option><option value='answer'>FALSE</option></select>\n\n**3. What is the effect size measure for ANOVA?**\n\n<input class='webex-solveme nospaces ignorecase' size='11' data-answer='[\"eta-squared\"]'/>\n\n:::\n\n# Summary\n\n::: {.callout-tip}\n## Key Skills Practised\n\n1. Running one-way ANOVA\n2. Conducting post-hoc comparisons\n3. Calculating effect sizes\n4. Running two-way ANOVA\n5. Interpreting interactions\n:::\n\n## Next Steps\n\n1. Download the **exercise** (.qmd file)\n2. Complete the analysis in RStudio\n3. Try the **follow-on exercise** for extra practice\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}