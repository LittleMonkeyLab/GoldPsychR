{
  "hash": "9fd5853593d0a6a72947b262d5329f21",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Boil in the Bag: Mixed ANOVA\"\nsubtitle: \"One between-subjects factor + one within-subjects factor\"\nformat: html\n---\n\n## Overview\n\n**Use this template when:** You have groups of different participants (between-subjects) measured at multiple time points (within-subjects).\n\n**Example scenarios:**\n- Treatment vs Control groups, measured Pre and Post\n- Male vs Female, tested under 3 conditions\n- Young vs Old, with repeated trials\n\n\n## Step 1: Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(afex)\nlibrary(emmeans)\nlibrary(effectsize)\n```\n:::\n\n\n\n## Step 2: Load Your Data\n\nData should be in **wide format** with separate columns for each time point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THIS: Replace with your data file\ndata <- read_csv(\"data/mixed_anova_data.csv\")\n\nglimpse(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 20\nColumns: 6\n$ id     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, …\n$ age    <dbl> 21, 22, 20, 23, 21, 22, 20, 24, 21, 22, 21, 22, 20, 23, 21, 22,…\n$ gender <dbl> 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2\n$ group  <chr> \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"B\", \"B\", \"B\"…\n$ time1  <dbl> 42, 45, 44, 47, 43, 46, 48, 45, 43, 50, 48, 51, 50, 53, 49, 52,…\n$ time2  <dbl> 48, 52, 50, 54, 49, 53, 55, 52, 50, 57, 62, 66, 64, 68, 63, 67,…\n```\n\n\n:::\n:::\n\n\n\n## Step 3: Define Your Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THESE to your variable names\nid_var <- \"id\"\nbetween_var <- \"group\"              # Between-subjects factor\ntime_vars <- c(\"time1\", \"time2\")    # Within-subjects columns\n\n# Convert between-subjects to factor\ndata <- data |>\n  mutate(across(all_of(between_var), as.factor))\n\ncat(\"Between-subjects levels:\", levels(data[[between_var]]), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBetween-subjects levels: A B \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Within-subjects levels:\", time_vars, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWithin-subjects levels: time1 time2 \n```\n\n\n:::\n:::\n\n\n\n## Step 4: Reshape to Long Format\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_long <- data |>\n  pivot_longer(\n    cols = all_of(time_vars),\n    names_to = \"time\",\n    values_to = \"score\"\n  ) |>\n  mutate(\n    time = factor(time, levels = time_vars)\n  )\n\nhead(data_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n     id   age gender group time  score\n  <dbl> <dbl>  <dbl> <fct> <fct> <dbl>\n1     1    21      1 A     time1    42\n2     1    21      1 A     time2    48\n3     2    22      2 A     time1    45\n4     2    22      2 A     time2    52\n5     3    20      1 A     time1    44\n6     3    20      1 A     time2    50\n```\n\n\n:::\n:::\n\n\n\n## Step 5: Descriptive Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cell means (Group × Time)\ndescriptives <- data_long |>\n  group_by(.data[[between_var]], time) |>\n  summarise(\n    n = n(),\n    mean = mean(score, na.rm = TRUE),\n    sd = sd(score, na.rm = TRUE),\n    se = sd / sqrt(n),\n    .groups = \"drop\"\n  )\n\nprint(descriptives)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n  group time      n  mean    sd    se\n  <fct> <fct> <int> <dbl> <dbl> <dbl>\n1 A     time1    10  45.3  2.50 0.790\n2 A     time2    10  52    2.83 0.894\n3 B     time1    10  51.3  2.50 0.790\n4 B     time2    10  66    2.83 0.894\n```\n\n\n:::\n\n```{.r .cell-code}\n# Marginal means\ncat(\"\\nMarginal means by group:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMarginal means by group:\n```\n\n\n:::\n\n```{.r .cell-code}\ndata_long |>\n  group_by(.data[[between_var]]) |>\n  summarise(mean = mean(score), sd = sd(score))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  group  mean    sd\n  <fct> <dbl> <dbl>\n1 A      48.6  4.31\n2 B      58.6  7.98\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nMarginal means by time:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMarginal means by time:\n```\n\n\n:::\n\n```{.r .cell-code}\ndata_long |>\n  group_by(time) |>\n  summarise(mean = mean(score), sd = sd(score))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  time   mean    sd\n  <fct> <dbl> <dbl>\n1 time1  48.3  3.92\n2 time2  59    7.69\n```\n\n\n:::\n:::\n\n\n### Visualise: Interaction Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(descriptives, aes(x = time, y = mean,\n                          color = .data[[between_var]],\n                          group = .data[[between_var]])) +\n  geom_point(size = 3) +\n  geom_line(linewidth = 1) +\n  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.1) +\n  labs(\n    x = \"Time\",\n    y = \"Mean Score\",\n    color = \"Group\",\n    title = \"Group × Time Interaction\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Group × Time interaction](06_mixed_anova_files/figure-html/interaction-plot-1.png){width=672}\n:::\n:::\n\n\n### Individual Trajectories\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_long, aes(x = time, y = score, group = .data[[id_var]])) +\n  geom_line(alpha = 0.3) +\n  geom_point(alpha = 0.3) +\n  stat_summary(aes(group = 1), fun = mean, geom = \"line\", color = \"red\", linewidth = 1.5) +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  facet_wrap(as.formula(paste(\"~\", between_var))) +\n  labs(x = \"Time\", y = \"Score\", title = \"Individual Trajectories by Group\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Individual change patterns by group](06_mixed_anova_files/figure-html/trajectories-1.png){width=672}\n:::\n:::\n\n\n\n## Step 6: Check Assumptions\n\n### Normality per Cell\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_long |>\n  group_by(.data[[between_var]], time) |>\n  summarise(\n    shapiro_p = shapiro.test(score)$p.value,\n    .groups = \"drop\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n  group time  shapiro_p\n  <fct> <fct>     <dbl>\n1 A     time1     0.783\n2 A     time2     0.903\n3 B     time1     0.783\n4 B     time2     0.903\n```\n\n\n:::\n:::\n\n\n### Homogeneity of Variance per Time Point\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n\n# At each time point\nfor (t in time_vars) {\n  cat(\"\\nLevene's test at\", t, \":\\n\")\n  test_data <- data_long |> filter(time == t)\n  print(leveneTest(as.formula(paste(\"score ~\", between_var)), data = test_data))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nLevene's test at time1 :\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  1       0      1\n      18               \n\nLevene's test at time2 :\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  1       0      1\n      18               \n```\n\n\n:::\n:::\n\n\n\n## Step 7: Run the Mixed ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmixed_anova <- aov_ez(\n  id = id_var,\n  dv = \"score\",\n  data = data_long,\n  between = between_var,\n  within = \"time\"\n)\n\n# Summary\nsummary(mixed_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nUnivariate Type III Repeated-Measures ANOVA Assuming Sphericity\n\n            Sum Sq num Df Error SS den Df  F value    Pr(>F)    \n(Intercept) 115133      1    254.1     18 8155.814 < 2.2e-16 ***\ngroup         1000      1    254.1     18   70.838 1.181e-07 ***\ntime          1145      1      2.1     18 9813.429 < 2.2e-16 ***\ngroup:time     160      1      2.1     18 1371.429 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Nice output\nnice(mixed_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type 3 tests)\n\nResponse: score\n      Effect    df   MSE           F  ges p.value\n1      group 1, 18 14.12   70.84 *** .796   <.001\n2       time 1, 18  0.12 9813.43 *** .817   <.001\n3 group:time 1, 18  0.12 1371.43 *** .384   <.001\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Step 8: Effect Sizes\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Generalized eta-squared is in nice() output\n# The ges column shows generalized eta-squared for each effect\n```\n:::\n\n\n\n## Step 9: Post-Hoc and Simple Effects\n\n### If Interaction is Significant\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemm <- emmeans(mixed_anova, specs = c(between_var, \"time\"))\nprint(emm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n group time  emmean    SE df lower.CL upper.CL\n A     time1   45.3 0.790 18     43.6     47.0\n B     time1   51.3 0.790 18     49.6     53.0\n A     time2   52.0 0.894 18     50.1     53.9\n B     time2   66.0 0.894 18     64.1     67.9\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Simple effect of time within each group\ncat(\"\\nSimple effect of time within each group:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSimple effect of time within each group:\n```\n\n\n:::\n\n```{.r .cell-code}\npairs(emm, by = between_var)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ngroup = A:\n contrast      estimate    SE df t.ratio p.value\n time1 - time2     -6.7 0.153 18 -43.862 <0.0001\n\ngroup = B:\n contrast      estimate    SE df t.ratio p.value\n time1 - time2    -14.7 0.153 18 -96.234 <0.0001\n```\n\n\n:::\n\n```{.r .cell-code}\n# Simple effect of group at each time point\ncat(\"\\nSimple effect of group at each time point:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSimple effect of group at each time point:\n```\n\n\n:::\n\n```{.r .cell-code}\npairs(emm, by = \"time\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntime = time1:\n contrast estimate   SE df t.ratio p.value\n A - B          -6 1.12 18  -5.374 <0.0001\n\ntime = time2:\n contrast estimate   SE df t.ratio p.value\n A - B         -14 1.26 18 -11.068 <0.0001\n```\n\n\n:::\n:::\n\n\n### Main Effects (if interaction not significant)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Main effect of group\ncat(\"\\nMain effect of group:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMain effect of group:\n```\n\n\n:::\n\n```{.r .cell-code}\nemmeans(mixed_anova, specs = between_var) |> pairs()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate   SE df t.ratio p.value\n A - B         -10 1.19 18  -8.417 <0.0001\n\nResults are averaged over the levels of: time \n```\n\n\n:::\n\n```{.r .cell-code}\n# Main effect of time\ncat(\"\\nMain effect of time:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMain effect of time:\n```\n\n\n:::\n\n```{.r .cell-code}\nemmeans(mixed_anova, specs = \"time\") |> pairs()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast      estimate    SE df t.ratio p.value\n time1 - time2    -10.7 0.108 18 -99.063 <0.0001\n\nResults are averaged over the levels of: group \n```\n\n\n:::\n:::\n\n\n\n## Step 10: Summary of Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"=== MIXED ANOVA RESULTS ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== MIXED ANOVA RESULTS ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"CELL MEANS:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCELL MEANS:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(descriptives)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n  group time      n  mean    sd    se\n  <fct> <fct> <int> <dbl> <dbl> <dbl>\n1 A     time1    10  45.3  2.50 0.790\n2 A     time2    10  52    2.83 0.894\n3 B     time1    10  51.3  2.50 0.790\n4 B     time2    10  66    2.83 0.894\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nANOVA RESULTS:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nANOVA RESULTS:\n```\n\n\n:::\n\n```{.r .cell-code}\nanova_nice <- nice(mixed_anova)\nprint(anova_nice)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type 3 tests)\n\nResponse: score\n      Effect    df   MSE           F  ges p.value\n1      group 1, 18 14.12   70.84 *** .796   <.001\n2       time 1, 18  0.12 9813.43 *** .817   <.001\n3 group:time 1, 18  0.12 1371.43 *** .384   <.001\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Step 11: APA Write-Up Template\n\n::: {.callout-note}\n## APA Format\n\nA mixed ANOVA with [BETWEEN FACTOR] ([LEVEL 1] vs [LEVEL 2]) as the between-subjects factor and time ([TIME 1] vs [TIME 2]) as the within-subjects factor was conducted on [OUTCOME].\n\n**Main effect of [BETWEEN]:** *F*(X, XX) = XX.XX, *p* = .XXX, η²~G~ = .XX. [Describe direction if significant.]\n\n**Main effect of time:** *F*(X, XX) = XX.XX, *p* = .XXX, η²~G~ = .XX. [Describe direction if significant.]\n\n**[BETWEEN] × Time interaction:** *F*(X, XX) = XX.XX, *p* = .XXX, η²~G~ = .XX.\n\n[If interaction significant:] Simple effects analysis revealed that [GROUP A] showed a significant change from [TIME 1] to [TIME 2], *p* = .XXX, while [GROUP B] [did/did not] show significant change, *p* = .XXX.\n:::\n\n\n## Checklist\n\n- [ ] Data in wide format with time points as columns\n- [ ] Between-subjects factor as factor\n- [ ] Data reshaped to long format\n- [ ] Cell means calculated\n- [ ] Interaction plot created\n- [ ] Assumptions checked\n- [ ] Mixed ANOVA run\n- [ ] Sphericity checked (for within-subjects factor)\n- [ ] Effect sizes noted (ges)\n- [ ] Simple effects explored (if interaction significant)\n- [ ] Results interpreted\n",
    "supporting": [
      "06_mixed_anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}