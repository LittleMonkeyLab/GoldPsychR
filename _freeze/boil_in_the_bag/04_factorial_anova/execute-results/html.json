{
  "hash": "d82335291c8d075f9ed82feb5937cd5d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Boil in the Bag: Factorial ANOVA (2x2)\"\nsubtitle: \"Two between-subjects factors with interaction\"\nformat: html\n---\n\n## Overview\n\n**Use this template when:** You have two categorical independent variables (between-subjects) and want to test their main effects and interaction on a continuous outcome.\n\n**Example scenarios:**\n- Treatment (drug vs placebo) × Gender (male vs female)\n- Condition (A vs B) × Age group (young vs old)\n- Framing (positive vs negative) × Information (present vs absent)\n\n\n## Step 1: Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(effectsize)\nlibrary(emmeans)\nlibrary(afex)  # For nice ANOVA output\n```\n:::\n\n\n\n## Step 2: Load Your Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THIS: Replace with your data file\ndata <- read_csv(\"data/factorial_anova_data.csv\")\n\nglimpse(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 32\nColumns: 6\n$ id       <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ age      <dbl> 21, 22, 20, 23, 21, 22, 20, 24, 21, 22, 20, 23, 21, 22, 20, 2…\n$ gender   <dbl> 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1…\n$ factor_a <chr> \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"…\n$ factor_b <chr> \"B1\", \"B1\", \"B1\", \"B1\", \"B1\", \"B1\", \"B1\", \"B1\", \"B2\", \"B2\", \"…\n$ score    <dbl> 42, 45, 44, 47, 43, 46, 48, 45, 52, 55, 54, 57, 53, 56, 58, 5…\n```\n\n\n:::\n:::\n\n\n\n## Step 3: Define Your Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THESE to your variable names\nfactor_a <- \"factor_a\"    # First IV (between-subjects)\nfactor_b <- \"factor_b\"    # Second IV (between-subjects)\noutcome_var <- \"score\"    # DV (continuous)\n\n# Convert to factors\ndata <- data |>\n  mutate(\n    across(all_of(c(factor_a, factor_b)), as.factor)\n  )\n\ncat(\"Factor A levels:\", levels(data[[factor_a]]), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFactor A levels: A1 A2 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Factor B levels:\", levels(data[[factor_b]]), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFactor B levels: B1 B2 \n```\n\n\n:::\n:::\n\n\n\n## Step 4: Descriptive Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cell means\ndescriptives <- data |>\n  group_by(.data[[factor_a]], .data[[factor_b]]) |>\n  summarise(\n    n = n(),\n    mean = mean(.data[[outcome_var]], na.rm = TRUE),\n    sd = sd(.data[[outcome_var]], na.rm = TRUE),\n    se = sd / sqrt(n),\n    .groups = \"drop\"\n  )\n\nprint(descriptives)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n  factor_a factor_b     n  mean    sd    se\n  <fct>    <fct>    <int> <dbl> <dbl> <dbl>\n1 A1       B1           8    45     2 0.707\n2 A1       B2           8    55     2 0.707\n3 A2       B1           8    51     2 0.707\n4 A2       B2           8    71     2 0.707\n```\n\n\n:::\n\n```{.r .cell-code}\n# Marginal means for Factor A\ndata |>\n  group_by(.data[[factor_a]]) |>\n  summarise(mean = mean(.data[[outcome_var]]), sd = sd(.data[[outcome_var]]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  factor_a  mean    sd\n  <fct>    <dbl> <dbl>\n1 A1          50  5.51\n2 A2          61 10.5 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Marginal means for Factor B\ndata |>\n  group_by(.data[[factor_b]]) |>\n  summarise(mean = mean(.data[[outcome_var]]), sd = sd(.data[[outcome_var]]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  factor_b  mean    sd\n  <fct>    <dbl> <dbl>\n1 B1          48  3.65\n2 B2          63  8.49\n```\n\n\n:::\n:::\n\n\n### Visualise: Interaction Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(descriptives, aes(x = .data[[factor_a]], y = mean,\n                          color = .data[[factor_b]], group = .data[[factor_b]])) +\n  geom_point(size = 3) +\n  geom_line(linewidth = 1) +\n  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.1) +\n  labs(\n    x = \"Factor A\",\n    y = \"Mean Score\",\n    color = \"Factor B\",\n    title = \"Interaction Plot\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Interaction plot](04_factorial_anova_files/figure-html/interaction-plot-1.png){width=672}\n:::\n:::\n\n\n### Visualise: Box Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = interaction(.data[[factor_a]], .data[[factor_b]]),\n                 y = .data[[outcome_var]],\n                 fill = .data[[factor_a]])) +\n  geom_boxplot(alpha = 0.7) +\n  geom_jitter(width = 0.1, alpha = 0.5) +\n  labs(\n    x = \"Condition (Factor A . Factor B)\",\n    y = \"Score\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Distribution by condition](04_factorial_anova_files/figure-html/boxplots-1.png){width=672}\n:::\n:::\n\n\n\n## Step 5: Check Assumptions\n\n### Normality per Cell\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |>\n  group_by(.data[[factor_a]], .data[[factor_b]]) |>\n  summarise(\n    shapiro_p = shapiro.test(.data[[outcome_var]])$p.value,\n    .groups = \"drop\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n  factor_a factor_b shapiro_p\n  <fct>    <fct>        <dbl>\n1 A1       B1           0.975\n2 A1       B2           0.975\n3 A2       B1           0.975\n4 A2       B2           0.975\n```\n\n\n:::\n:::\n\n\n### Homogeneity of Variance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nleveneTest(as.formula(paste(outcome_var, \"~\", factor_a, \"*\", factor_b)), data = data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  3       0      1\n      28               \n```\n\n\n:::\n:::\n\n\n\n## Step 6: Run the Factorial ANOVA\n\n### Using Base R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_model <- aov(\n  as.formula(paste(outcome_var, \"~\", factor_a, \"*\", factor_b)),\n  data = data\n)\n\nsummary(anova_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Df Sum Sq Mean Sq F value   Pr(>F)    \nfactor_a           1    968     968     242 2.62e-15 ***\nfactor_b           1   1800    1800     450  < 2e-16 ***\nfactor_a:factor_b  1    200     200      50 1.08e-07 ***\nResiduals         28    112       4                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n### Using afex (nicer output with effect sizes)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_afex <- aov_ez(\n  id = \"id\",\n  dv = outcome_var,\n  data = data,\n  between = c(factor_a, factor_b)\n)\n\n# Nice summary table\nnice(anova_afex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type 3 tests)\n\nResponse: score\n             Effect    df  MSE          F  ges p.value\n1          factor_a 1, 28 4.00 242.00 *** .896   <.001\n2          factor_b 1, 28 4.00 450.00 *** .941   <.001\n3 factor_a:factor_b 1, 28 4.00  50.00 *** .641   <.001\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Step 7: Effect Sizes\n\n\n::: {.cell}\n\n```{.r .cell-code}\neta <- eta_squared(anova_model)\nprint(eta)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Effect Size for ANOVA (Type I)\n\nParameter         | Eta2 (partial) |       95% CI\n-------------------------------------------------\nfactor_a          |           0.90 | [0.83, 1.00]\nfactor_b          |           0.94 | [0.90, 1.00]\nfactor_a:factor_b |           0.64 | [0.45, 1.00]\n\n- One-sided CIs: upper bound fixed at [1.00].\n```\n\n\n:::\n:::\n\n\n\n## Step 8: Post-Hoc Comparisons\n\n### Simple Effects (if interaction is significant)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemm <- emmeans(anova_model, specs = c(factor_a, factor_b))\n\n# Simple effects of Factor A at each level of Factor B\npairs(emm, by = factor_b)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nfactor_b = B1:\n contrast estimate SE df t.ratio p.value\n A1 - A2        -6  1 28  -6.000 <0.0001\n\nfactor_b = B2:\n contrast estimate SE df t.ratio p.value\n A1 - A2       -16  1 28 -16.000 <0.0001\n```\n\n\n:::\n\n```{.r .cell-code}\n# Simple effects of Factor B at each level of Factor A\npairs(emm, by = factor_a)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nfactor_a = A1:\n contrast estimate SE df t.ratio p.value\n B1 - B2       -10  1 28 -10.000 <0.0001\n\nfactor_a = A2:\n contrast estimate SE df t.ratio p.value\n B1 - B2       -20  1 28 -20.000 <0.0001\n```\n\n\n:::\n:::\n\n\n### Main Effect Comparisons (if main effects significant)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Factor A marginal means\nemmeans(anova_model, specs = factor_a) |> pairs()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate    SE df t.ratio p.value\n A1 - A2       -11 0.707 28 -15.556 <0.0001\n\nResults are averaged over the levels of: factor_b \n```\n\n\n:::\n\n```{.r .cell-code}\n# Factor B marginal means\nemmeans(anova_model, specs = factor_b) |> pairs()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate    SE df t.ratio p.value\n B1 - B2       -15 0.707 28 -21.213 <0.0001\n\nResults are averaged over the levels of: factor_a \n```\n\n\n:::\n:::\n\n\n\n## Step 9: Summary of Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_table <- summary(anova_model)[[1]]\n\ncat(\"=== FACTORIAL ANOVA RESULTS ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== FACTORIAL ANOVA RESULTS ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"CELL MEANS:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCELL MEANS:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(descriptives)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n  factor_a factor_b     n  mean    sd    se\n  <fct>    <fct>    <int> <dbl> <dbl> <dbl>\n1 A1       B1           8    45     2 0.707\n2 A1       B2           8    55     2 0.707\n3 A2       B1           8    51     2 0.707\n4 A2       B2           8    71     2 0.707\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nANOVA TABLE:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nANOVA TABLE:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(sprintf(\"  %s: F(%d, %d) = %.2f, p = %.3f, η² = %.3f\\n\",\n            factor_a,\n            anova_table$Df[1], anova_table$Df[4],\n            anova_table$`F value`[1], anova_table$`Pr(>F)`[1],\n            eta$Eta2[1]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  factor_a: F(1, 28) = 242.00, p = 0.000, η² = 0.896\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(sprintf(\"  %s: F(%d, %d) = %.2f, p = %.3f, η² = %.3f\\n\",\n            factor_b,\n            anova_table$Df[2], anova_table$Df[4],\n            anova_table$`F value`[2], anova_table$`Pr(>F)`[2],\n            eta$Eta2[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  factor_b: F(1, 28) = 450.00, p = 0.000, η² = 0.941\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(sprintf(\"  %s × %s: F(%d, %d) = %.2f, p = %.3f, η² = %.3f\\n\",\n            factor_a, factor_b,\n            anova_table$Df[3], anova_table$Df[4],\n            anova_table$`F value`[3], anova_table$`Pr(>F)`[3],\n            eta$Eta2[3]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  factor_a × factor_b: F(1, 28) = 50.00, p = 0.000, η² = 0.641\n```\n\n\n:::\n:::\n\n\n\n## Step 10: APA Write-Up Template\n\n::: {.callout-note}\n## APA Format\n\nA 2 × 2 between-subjects ANOVA was conducted to examine the effects of [FACTOR A] and [FACTOR B] on [OUTCOME].\n\nThere was a [significant/non-significant] main effect of [FACTOR A], *F*(1, XX) = XX.XX, *p* = .XXX, η² = .XX.\n\nThere was a [significant/non-significant] main effect of [FACTOR B], *F*(1, XX) = XX.XX, *p* = .XXX, η² = .XX.\n\nThe interaction between [FACTOR A] and [FACTOR B] was [significant/non-significant], *F*(1, XX) = XX.XX, *p* = .XXX, η² = .XX.\n\n[If interaction significant:] Simple effects analysis revealed that [describe the pattern of the interaction].\n:::\n\n\n## Checklist\n\n- [ ] Data loaded correctly\n- [ ] Both factors defined as factors\n- [ ] Cell means and marginal means calculated\n- [ ] Interaction plot created\n- [ ] Assumptions checked\n- [ ] Factorial ANOVA run\n- [ ] Effect sizes calculated\n- [ ] Simple effects explored (if interaction significant)\n- [ ] Results interpreted\n",
    "supporting": [
      "04_factorial_anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}