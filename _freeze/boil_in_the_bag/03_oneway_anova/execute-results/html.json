{
  "hash": "38583280bf701a1b91066261a0e4f8a8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Boil in the Bag: One-Way ANOVA\"\nsubtitle: \"Comparing three or more independent groups\"\nformat: html\n---\n\n## Overview\n\n**Use this template when:** You have three or more different groups of participants and want to compare their scores on a continuous outcome.\n\n**Example scenarios:**\n- Comparing 3 teaching methods\n- Comparing 4 treatment conditions\n- Comparing performance across multiple sites\n\n\n## Step 1: Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(effectsize)\nlibrary(emmeans)     # For post-hoc comparisons\n```\n:::\n\n\n\n## Step 2: Load Your Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THIS: Replace with your data file\ndata <- read_csv(\"data/oneway_anova_data.csv\")\n\nglimpse(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30\nColumns: 5\n$ id     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, …\n$ age    <dbl> 21, 22, 20, 23, 21, 22, 20, 24, 21, 22, 21, 22, 20, 23, 21, 22,…\n$ gender <dbl> 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, …\n$ group  <chr> \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"B\", \"B\", \"B\"…\n$ score  <dbl> 42, 45, 48, 44, 47, 43, 46, 49, 45, 47, 55, 58, 52, 56, 59, 54,…\n```\n\n\n:::\n:::\n\n\n\n## Step 3: Define Your Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THESE to your variable names\ngroup_var <- \"group\"      # Your grouping variable (3+ levels)\noutcome_var <- \"score\"    # Your outcome variable\n\n# Convert to factor\ndata <- data |>\n  mutate(across(all_of(group_var), as.factor))\n\ncat(\"Group levels:\", levels(data[[group_var]]), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGroup levels: A B C \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"N per group:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nN per group:\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(data[[group_var]])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n A  B  C \n10 10 10 \n```\n\n\n:::\n:::\n\n\n\n## Step 4: Descriptive Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescriptives <- data |>\n  group_by(.data[[group_var]]) |>\n  summarise(\n    n = n(),\n    mean = mean(.data[[outcome_var]], na.rm = TRUE),\n    sd = sd(.data[[outcome_var]], na.rm = TRUE),\n    se = sd / sqrt(n),\n    ci_lower = mean - 1.96 * se,\n    ci_upper = mean + 1.96 * se\n  )\n\nprint(descriptives)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 7\n  group     n  mean    sd    se ci_lower ci_upper\n  <fct> <int> <dbl> <dbl> <dbl>    <dbl>    <dbl>\n1 A        10  45.6  2.22 0.702     44.2     47.0\n2 B        10  55.8  2.30 0.727     54.4     57.2\n3 C        10  66.5  2.42 0.764     65.0     68.0\n```\n\n\n:::\n:::\n\n\n### Visualise the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = .data[[group_var]], y = .data[[outcome_var]], fill = .data[[group_var]])) +\n  geom_boxplot(alpha = 0.7) +\n  geom_jitter(width = 0.1, alpha = 0.5) +\n  stat_summary(fun = mean, geom = \"point\", shape = 18, size = 4, color = \"red\") +\n  labs(\n    x = \"Group\",\n    y = \"Score\",\n    title = \"Distribution by Group\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Comparison across groups](03_oneway_anova_files/figure-html/visualise-1.png){width=672}\n:::\n:::\n\n\n\n## Step 5: Check Assumptions\n\n### Assumption 1: Normality (per group)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |>\n  group_by(.data[[group_var]]) |>\n  summarise(\n    shapiro_W = shapiro.test(.data[[outcome_var]])$statistic,\n    shapiro_p = shapiro.test(.data[[outcome_var]])$p.value\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  group shapiro_W shapiro_p\n  <fct>     <dbl>     <dbl>\n1 A         0.978     0.953\n2 B         0.961     0.799\n3 C         0.977     0.950\n```\n\n\n:::\n:::\n\n\n### Assumption 2: Homogeneity of Variance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nleveneTest(as.formula(paste(outcome_var, \"~\", group_var)), data = data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  2  0.0204 0.9798\n      27               \n```\n\n\n:::\n:::\n\n\n\n## Step 6: Run the One-Way ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run ANOVA\nanova_model <- aov(as.formula(paste(outcome_var, \"~\", group_var)), data = data)\n\n# Summary\nsummary(anova_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value Pr(>F)    \ngroup        2 2184.5  1092.2   204.1 <2e-16 ***\nResiduals   27  144.5     5.4                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Step 7: Effect Size\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Eta-squared and partial eta-squared\neta <- eta_squared(anova_model)\nprint(eta)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Effect Size for ANOVA\n\nParameter | Eta2 |       95% CI\n-------------------------------\ngroup     | 0.94 | [0.90, 1.00]\n\n- One-sided CIs: upper bound fixed at [1.00].\n```\n\n\n:::\n\n```{.r .cell-code}\n# Omega-squared (less biased)\nomega <- omega_squared(anova_model)\nprint(omega)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Effect Size for ANOVA\n\nParameter | Omega2 |       95% CI\n---------------------------------\ngroup     |   0.93 | [0.89, 1.00]\n\n- One-sided CIs: upper bound fixed at [1.00].\n```\n\n\n:::\n:::\n\n\n**Interpretation:** η² = .01 (small), .06 (medium), .14 (large)\n\n\n## Step 8: Post-Hoc Comparisons\n\nOnly interpret if ANOVA is significant.\n\n### Tukey HSD\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntukey_result <- TukeyHSD(anova_model)\nprint(tukey_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = as.formula(paste(outcome_var, \"~\", group_var)), data = data)\n\n$group\n    diff       lwr      upr p adj\nB-A 10.2  7.634827 12.76517     0\nC-A 20.9 18.334827 23.46517     0\nC-B 10.7  8.134827 13.26517     0\n```\n\n\n:::\n:::\n\n\n### Using emmeans (more flexible)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Estimated marginal means\nemm <- emmeans(anova_model, specs = group_var)\nprint(emm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n group emmean    SE df lower.CL upper.CL\n A       45.6 0.732 27     44.1     47.1\n B       55.8 0.732 27     54.3     57.3\n C       66.5 0.732 27     65.0     68.0\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Pairwise comparisons with Tukey adjustment\npairs(emm, adjust = \"tukey\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate   SE df t.ratio p.value\n A - B       -10.2 1.03 27  -9.859 <0.0001\n A - C       -20.9 1.03 27 -20.201 <0.0001\n B - C       -10.7 1.03 27 -10.342 <0.0001\n\nP value adjustment: tukey method for comparing a family of 3 estimates \n```\n\n\n:::\n:::\n\n\n\n## Step 9: Summary of Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract ANOVA results\nanova_summary <- summary(anova_model)[[1]]\n\ncat(\"=== ONE-WAY ANOVA RESULTS ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== ONE-WAY ANOVA RESULTS ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"DESCRIPTIVES:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDESCRIPTIVES:\n```\n\n\n:::\n\n```{.r .cell-code}\nfor (i in 1:nrow(descriptives)) {\n  cat(sprintf(\"  %s: M = %.2f, SD = %.2f, n = %d\\n\",\n              descriptives[[group_var]][i],\n              descriptives$mean[i],\n              descriptives$sd[i],\n              descriptives$n[i]))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  A: M = 45.60, SD = 2.22, n = 10\n  B: M = 55.80, SD = 2.30, n = 10\n  C: M = 66.50, SD = 2.42, n = 10\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nANOVA RESULTS:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nANOVA RESULTS:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(sprintf(\"  F(%d, %d) = %.2f, p = %.3f\\n\",\n            anova_summary$Df[1],\n            anova_summary$Df[2],\n            anova_summary$`F value`[1],\n            anova_summary$`Pr(>F)`[1]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  F(2, 27) = 204.09, p = 0.000\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(sprintf(\"  η² = %.3f\\n\", eta$Eta2[1]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  η² = 0.938\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nPOST-HOC (Tukey HSD):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nPOST-HOC (Tukey HSD):\n```\n\n\n:::\n\n```{.r .cell-code}\ntukey_df <- as.data.frame(tukey_result[[1]])\nfor (i in 1:nrow(tukey_df)) {\n  cat(sprintf(\"  %s: diff = %.2f, p = %.3f\\n\",\n              rownames(tukey_df)[i],\n              tukey_df$diff[i],\n              tukey_df$`p adj`[i]))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  B-A: diff = 10.20, p = 0.000\n  C-A: diff = 20.90, p = 0.000\n  C-B: diff = 10.70, p = 0.000\n```\n\n\n:::\n:::\n\n\n\n## Step 10: APA Write-Up Template\n\n::: {.callout-note}\n## APA Format\n\nA one-way ANOVA was conducted to compare [OUTCOME] across [NUMBER] groups ([LIST GROUPS]). There was a [significant/non-significant] effect of [GROUP VARIABLE] on [OUTCOME], *F*(XX, XX) = XX.XX, *p* = .XXX, η² = .XX.\n\nPost-hoc comparisons using Tukey's HSD indicated that [GROUP A] (*M* = XX.XX, *SD* = XX.XX) was significantly different from [GROUP B] (*M* = XX.XX, *SD* = XX.XX), *p* = .XXX. [Continue for other significant comparisons...]\n:::\n\n\n## Checklist\n\n- [ ] Data loaded correctly\n- [ ] Variables renamed\n- [ ] Assumptions checked (normality, homogeneity)\n- [ ] ANOVA run\n- [ ] Effect size calculated\n- [ ] Post-hoc tests run (if ANOVA significant)\n- [ ] Results interpreted\n",
    "supporting": [
      "03_oneway_anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}