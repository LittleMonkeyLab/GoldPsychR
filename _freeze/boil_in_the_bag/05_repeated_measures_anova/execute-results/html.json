{
  "hash": "a4d46054ba8e162a4faf00e894b5862a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Boil in the Bag: Repeated Measures ANOVA\"\nsubtitle: \"Comparing three or more related measurements\"\nformat: html\n---\n\n## Overview\n\n**Use this template when:** You have the same participants measured at three or more time points (or conditions).\n\n**Example scenarios:**\n- Pre, Post, Follow-up measurements\n- Three different experimental conditions (within-subjects)\n- Performance across multiple trials\n\n\n## Step 1: Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(afex)       # For repeated measures ANOVA\nlibrary(emmeans)    # For post-hoc\nlibrary(effectsize)\n```\n:::\n\n\n\n## Step 2: Load Your Data\n\nData should be in **wide format** (one row per participant, separate columns for each time point).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THIS: Replace with your data file\ndata <- read_csv(\"data/repeated_measures_data.csv\")\n\nglimpse(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 20\nColumns: 6\n$ id     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, …\n$ age    <dbl> 21, 22, 20, 23, 21, 22, 20, 24, 21, 22, 23, 20, 21, 22, 20, 21,…\n$ gender <dbl> 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1\n$ time1  <dbl> 42, 45, 44, 47, 43, 46, 48, 45, 43, 50, 48, 45, 47, 52, 44, 46,…\n$ time2  <dbl> 48, 52, 50, 53, 49, 52, 54, 51, 49, 56, 54, 51, 53, 58, 50, 52,…\n$ time3  <dbl> 55, 58, 56, 60, 55, 59, 61, 57, 56, 63, 60, 58, 59, 65, 56, 58,…\n```\n\n\n:::\n:::\n\n\n\n## Step 3: Define Your Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CHANGE THESE to your variable names\nid_var <- \"id\"\ntime_vars <- c(\"time1\", \"time2\", \"time3\")  # Your repeated measures columns\n\n# Check data\ncat(\"N participants:\", nrow(data), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nN participants: 20 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Time points:\", length(time_vars), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTime points: 3 \n```\n\n\n:::\n:::\n\n\n\n## Step 4: Reshape to Long Format\n\nRepeated measures ANOVA requires long format data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_long <- data |>\n  pivot_longer(\n    cols = all_of(time_vars),\n    names_to = \"time\",\n    values_to = \"score\"\n  ) |>\n  mutate(\n    time = factor(time, levels = time_vars)\n  )\n\nhead(data_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n     id   age gender time  score\n  <dbl> <dbl>  <dbl> <fct> <dbl>\n1     1    21      1 time1    42\n2     1    21      1 time2    48\n3     1    21      1 time3    55\n4     2    22      2 time1    45\n5     2    22      2 time2    52\n6     2    22      2 time3    58\n```\n\n\n:::\n:::\n\n\n\n## Step 5: Descriptive Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescriptives <- data_long |>\n  group_by(time) |>\n  summarise(\n    n = n(),\n    mean = mean(score, na.rm = TRUE),\n    sd = sd(score, na.rm = TRUE),\n    se = sd / sqrt(n)\n  )\n\nprint(descriptives)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  time      n  mean    sd    se\n  <fct> <int> <dbl> <dbl> <dbl>\n1 time1    20  46.3  2.83 0.633\n2 time2    20  52.4  2.81 0.629\n3 time3    20  58.8  3.03 0.678\n```\n\n\n:::\n:::\n\n\n### Visualise the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_long, aes(x = time, y = score)) +\n  geom_boxplot(alpha = 0.3, width = 0.3) +\n  geom_line(aes(group = .data[[id_var]]), alpha = 0.3) +\n  geom_point(alpha = 0.3) +\n  stat_summary(fun = mean, geom = \"point\", shape = 18, size = 5, color = \"red\") +\n  stat_summary(fun = mean, geom = \"line\", aes(group = 1), color = \"red\", linewidth = 1) +\n  labs(\n    x = \"Time\",\n    y = \"Score\",\n    title = \"Change Across Time Points\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Individual trajectories across time](05_repeated_measures_anova_files/figure-html/visualise-1.png){width=672}\n:::\n:::\n\n\n\n## Step 6: Check Assumptions\n\n### Normality at Each Time Point\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_long |>\n  group_by(time) |>\n  summarise(\n    shapiro_W = shapiro.test(score)$statistic,\n    shapiro_p = shapiro.test(score)$p.value\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  time  shapiro_W shapiro_p\n  <fct>     <dbl>     <dbl>\n1 time1     0.960     0.544\n2 time2     0.964     0.621\n3 time3     0.939     0.234\n```\n\n\n:::\n:::\n\n\n### Sphericity\n\nSphericity is tested automatically in afex and Mauchly's test is reported.\n\n\n## Step 7: Run the Repeated Measures ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm_anova <- aov_ez(\n  id = id_var,\n  dv = \"score\",\n  data = data_long,\n  within = \"time\"\n)\n\n# Summary with sphericity correction\nsummary(rm_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nUnivariate Type III Repeated-Measures ANOVA Assuming Sphericity\n\n            Sum Sq num Df Error SS den Df F value    Pr(>F)    \n(Intercept) 165375      1   473.67     19  6633.6 < 2.2e-16 ***\ntime          1576      2     3.63     38  8239.9 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nMauchly Tests for Sphericity\n\n     Test statistic    p-value\ntime        0.45451 0.00082769\n\n\nGreenhouse-Geisser and Huynh-Feldt Corrections\n for Departure from Sphericity\n\n      GG eps Pr(>F[GG])    \ntime 0.64704  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n        HF eps   Pr(>F[HF])\ntime 0.6743993 5.061392e-35\n```\n\n\n:::\n\n```{.r .cell-code}\n# Nice output\nnice(rm_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type 3 tests)\n\nResponse: score\n  Effect          df  MSE           F  ges p.value\n1   time 1.29, 24.59 0.15 8239.90 *** .768   <.001\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1\n\nSphericity correction method: GG \n```\n\n\n:::\n:::\n\n\n### Mauchly's Test for Sphericity\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mauchly's test is in the summary\n# If p < .05, sphericity is violated - use Greenhouse-Geisser correction (GGe)\n```\n:::\n\n\n\n## Step 8: Effect Size\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Generalized eta-squared is in the nice() output\n# Or calculate partial eta-squared:\neta_squared(rm_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Effect Size for ANOVA (Type III)\n\nParameter | Eta2 (partial) |       95% CI\n-----------------------------------------\ntime      |           1.00 | [1.00, 1.00]\n\n- One-sided CIs: upper bound fixed at [1.00].\n```\n\n\n:::\n:::\n\n\n\n## Step 9: Post-Hoc Pairwise Comparisons\n\nOnly interpret if ANOVA is significant.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemm <- emmeans(rm_anova, specs = \"time\")\nprint(emm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n time  emmean    SE df lower.CL upper.CL\n time1   46.3 0.633 19     45.0     47.6\n time2   52.4 0.629 19     51.0     53.7\n time3   58.9 0.678 19     57.4     60.3\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Pairwise comparisons with Bonferroni correction\npairs(emm, adjust = \"bonferroni\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast      estimate    SE df  t.ratio p.value\n time1 - time2    -6.05 0.050 19 -121.000 <0.0001\n time1 - time3   -12.55 0.114 19 -109.960 <0.0001\n time2 - time3    -6.50 0.115 19  -56.666 <0.0001\n\nP value adjustment: bonferroni method for 3 tests \n```\n\n\n:::\n:::\n\n\n\n## Step 10: Summary of Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"=== REPEATED MEASURES ANOVA RESULTS ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== REPEATED MEASURES ANOVA RESULTS ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"DESCRIPTIVES:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDESCRIPTIVES:\n```\n\n\n:::\n\n```{.r .cell-code}\nfor (i in 1:nrow(descriptives)) {\n  cat(sprintf(\"  %s: M = %.2f, SD = %.2f\\n\",\n              descriptives$time[i],\n              descriptives$mean[i],\n              descriptives$sd[i]))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  time1: M = 46.30, SD = 2.83\n  time2: M = 52.35, SD = 2.81\n  time3: M = 58.85, SD = 3.03\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extract results from afex\nanova_table <- nice(rm_anova)\ncat(\"\\nRM ANOVA:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nRM ANOVA:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(sprintf(\"  Effect of time: F(%.2f, %.2f) = %.2f, p = %s, ges = %.3f\\n\",\n            anova_table$`num Df`,\n            anova_table$`den Df`,\n            anova_table$F,\n            anova_table$`p.value`,\n            anova_table$ges))\n\ncat(\"\\nNote: If sphericity violated (Mauchly's p < .05),\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nNote: If sphericity violated (Mauchly's p < .05),\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"      use Greenhouse-Geisser corrected values (GGe columns)\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      use Greenhouse-Geisser corrected values (GGe columns)\n```\n\n\n:::\n:::\n\n\n\n## Step 11: APA Write-Up Template\n\n::: {.callout-note}\n## APA Format (Sphericity Assumed)\n\nA one-way repeated measures ANOVA was conducted to compare [OUTCOME] across [NUMBER] time points. There was a [significant/non-significant] effect of time, *F*(X, XX) = XX.XX, *p* = .XXX, η²~G~ = .XX.\n\nPost-hoc pairwise comparisons with Bonferroni correction revealed that [TIME 1] (*M* = XX.XX, *SD* = XX.XX) was significantly different from [TIME 2] (*M* = XX.XX, *SD* = XX.XX), *p* = .XXX. [Continue for significant comparisons...]\n:::\n\n::: {.callout-note}\n## APA Format (Sphericity Violated)\n\nMauchly's test indicated that the assumption of sphericity had been violated, χ²(X) = XX.XX, *p* = .XXX. Therefore, a Greenhouse-Geisser correction was applied (ε = .XX). There was a [significant/non-significant] effect of time, *F*(X.XX, XX.XX) = XX.XX, *p* = .XXX, η²~G~ = .XX.\n:::\n\n\n## Checklist\n\n- [ ] Data in wide format (one row per participant)\n- [ ] Data reshaped to long format\n- [ ] Time variable as factor\n- [ ] Descriptives calculated\n- [ ] Normality checked per time point\n- [ ] RM ANOVA run\n- [ ] Sphericity checked (Mauchly's test)\n- [ ] Correction applied if needed (GG or HF)\n- [ ] Post-hoc comparisons run\n- [ ] Results interpreted\n",
    "supporting": [
      "05_repeated_measures_anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}