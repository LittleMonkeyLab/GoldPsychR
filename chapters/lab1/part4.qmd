---
title: "Part 4: Descriptives & Plots"
subtitle: "Lab 1: Descriptive Statistics"
format: html
filters:
  - webr
webr:
  packages: ['readr', 'dplyr', 'ggplot2']
  show-startup-message: false
---

```{r, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

In this part, you'll learn to calculate descriptive statistics by group and create visualizations with ggplot2.

## Watch the Demo

Follow along with the slides below.

```{=html}
<iframe src="part4-slides.html" width="100%" height="500px" style="border: 1px solid #ccc; border-radius: 8px;"></iframe>
```

::: {.callout-tip}
## Tip
Click inside the slide area first, then use arrow keys to navigate.
:::

---

## Try It Yourself

::: {.callout-tip}
## How to Practice
1. **Run the code** to see statistics and plots
2. **Modify** the grouping variables and aesthetics
3. **Copy to RStudio** for your assignment
:::

### Setup: Load Everything

```{webr-r}
# Load packages
library(readr)
library(dplyr)
library(ggplot2)

# Load and prepare data
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/Y1_Week13_Lab1_grit_data.csv"
data <- read_csv(data_url, show_col_types = FALSE)

# Reverse-score items (from Part 3)
data$rev_G1 <- 6 - data$G1
data$rev_G3 <- 6 - data$G3
data$rev_G5 <- 6 - data$G5
data$rev_G6 <- 6 - data$G6

# Create subscales
data$consistency <- data$rev_G1 + data$rev_G3 + data$rev_G5 + data$rev_G6
data$perseverance <- data$G2 + data$G4 + data$G7 + data$G8

cat("Ready! Data has", nrow(data), "rows with consistency and perseverance subscales.")
```

### Basic Statistics

Calculate mean, SD, and n for Consistency of Interest:

```{webr-r}
library(readr)
library(dplyr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/Y1_Week13_Lab1_grit_data.csv"
data <- read_csv(data_url, show_col_types = FALSE)
data$rev_G1 <- 6 - data$G1
data$rev_G3 <- 6 - data$G3
data$rev_G5 <- 6 - data$G5
data$rev_G6 <- 6 - data$G6
data$consistency <- data$rev_G1 + data$rev_G3 + data$rev_G5 + data$rev_G6
data$perseverance <- data$G2 + data$G4 + data$G7 + data$G8

# Overall statistics for Consistency
cat("Consistency of Interest:\n")
cat("Mean:", round(mean(data$consistency), 2), "\n")
cat("SD:", round(sd(data$consistency), 2), "\n")
cat("N:", length(data$consistency), "\n")
```

### Grouped by Study Year

Statistics by Study_Year:

```{webr-r}
library(readr)
library(dplyr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/Y1_Week13_Lab1_grit_data.csv"
data <- read_csv(data_url, show_col_types = FALSE)
data$rev_G1 <- 6 - data$G1
data$rev_G3 <- 6 - data$G3
data$rev_G5 <- 6 - data$G5
data$rev_G6 <- 6 - data$G6
data$consistency <- data$rev_G1 + data$rev_G3 + data$rev_G5 + data$rev_G6
data$perseverance <- data$G2 + data$G4 + data$G7 + data$G8

data |>
  group_by(Study_Year) |>
  summarise(
    mean_consistency = mean(consistency, na.rm = TRUE),
    sd_consistency = sd(consistency, na.rm = TRUE),
    mean_perseverance = mean(perseverance, na.rm = TRUE),
    sd_perseverance = sd(perseverance, na.rm = TRUE),
    n = n()
  )
```

::: {.callout-note}
## Challenge
Try calculating statistics grouped by `Gender` instead of `Study_Year`.
:::

### Statistics for Both Subscales

Compare Consistency and Perseverance by Study Year:

```{webr-r}
library(readr)
library(dplyr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/Y1_Week13_Lab1_grit_data.csv"
data <- read_csv(data_url, show_col_types = FALSE)
data$rev_G1 <- 6 - data$G1
data$rev_G3 <- 6 - data$G3
data$rev_G5 <- 6 - data$G5
data$rev_G6 <- 6 - data$G6
data$consistency <- data$rev_G1 + data$rev_G3 + data$rev_G5 + data$rev_G6
data$perseverance <- data$G2 + data$G4 + data$G7 + data$G8

# Convert Study_Year to factor for better plotting
data$Study_Year <- factor(data$Study_Year)

data_summary <- data |>
  group_by(Study_Year) |>
  summarise(
    mean_consistency = mean(consistency, na.rm = TRUE),
    sd_consistency = sd(consistency, na.rm = TRUE),
    mean_perseverance = mean(perseverance, na.rm = TRUE),
    sd_perseverance = sd(perseverance, na.rm = TRUE),
    n = n(),
    .groups = "drop"
  )

data_summary
```

### Simple Boxplot

Boxplot for Consistency of Interest by Study Year:

```{webr-r}
library(readr)
library(ggplot2)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/Y1_Week13_Lab1_grit_data.csv"
data <- read_csv(data_url, show_col_types = FALSE)
data$rev_G1 <- 6 - data$G1
data$rev_G3 <- 6 - data$G3
data$rev_G5 <- 6 - data$G5
data$rev_G6 <- 6 - data$G6
data$consistency <- data$rev_G1 + data$rev_G3 + data$rev_G5 + data$rev_G6
data$perseverance <- data$G2 + data$G4 + data$G7 + data$G8
data$Study_Year <- factor(data$Study_Year)

ggplot(data, aes(x = Study_Year, y = consistency)) +
  geom_boxplot()
```

### Boxplot with Fill

Add colour to distinguish groups:

```{webr-r}
library(readr)
library(ggplot2)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/Y1_Week13_Lab1_grit_data.csv"
data <- read_csv(data_url, show_col_types = FALSE)
data$rev_G1 <- 6 - data$G1
data$rev_G3 <- 6 - data$G3
data$rev_G5 <- 6 - data$G5
data$rev_G6 <- 6 - data$G6
data$consistency <- data$rev_G1 + data$rev_G3 + data$rev_G5 + data$rev_G6
data$perseverance <- data$G2 + data$G4 + data$G7 + data$G8
data$Study_Year <- factor(data$Study_Year)

ggplot(data, aes(x = Study_Year, y = consistency, fill = Study_Year)) +
  geom_boxplot(alpha = 0.7)
```

### Publication-Ready Plot

```{webr-r}
library(readr)
library(ggplot2)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/Y1_Week13_Lab1_grit_data.csv"
data <- read_csv(data_url, show_col_types = FALSE)
data$rev_G1 <- 6 - data$G1
data$rev_G3 <- 6 - data$G3
data$rev_G5 <- 6 - data$G5
data$rev_G6 <- 6 - data$G6
data$consistency <- data$rev_G1 + data$rev_G3 + data$rev_G5 + data$rev_G6
data$perseverance <- data$G2 + data$G4 + data$G7 + data$G8
data$Study_Year <- factor(data$Study_Year)

ggplot(data, aes(x = Study_Year, y = consistency, fill = Study_Year)) +
  geom_boxplot(alpha = 0.7) +
  theme_minimal() +
  labs(
    title = "Consistency of Interest by Study Year",
    x = "Study Year",
    y = "Consistency of Interest Score",
    fill = "Study Year"
  ) +
  scale_fill_manual(values = c("#E8A87C", "#41B3A3")) +
  theme(legend.position = "none")
```

::: {.callout-note}
## Challenge
Try changing `theme_minimal()` to `theme_classic()` or `theme_bw()`.
:::

---

## Self-Assessment

Check your understanding before moving on.

::: {.webex-check .webex-box}

**1. What function calculates the average of a numeric vector?**

`r mcq(c("median()", answer = "mean()", "mode()", "average()"))`

**2. To calculate statistics separately for each group, you first use:**

`r mcq(c("summarise()", answer = "group_by()", "filter()", "select()"))`

**3. The pipe operator `|>` allows you to:**

`r mcq(c("Create new variables", answer = "Chain multiple operations together", "Load data files", "Create plots"))`

**4. In `ggplot2`, what does `geom_boxplot()` create?**

`r mcq(c("A scatter plot", answer = "A boxplot showing distribution", "A line graph", "A bar chart"))`

**5. When using `summarise()`, what does `n()` calculate?**

`r mcq(c("The mean value", answer = "The number of observations", "The standard deviation", "The median value"))`

**6. True or False: You must use `na.rm = TRUE` when calculating statistics if your data has missing values.**

`r torf(TRUE)`

:::

---

## Next Steps

::: {.d-flex .justify-content-between}
[← Back to Part 3](part3.qmd){.btn .btn-secondary}

[Continue to Part 5: APA Write-Up →](part5.qmd){.btn .btn-primary}
:::
