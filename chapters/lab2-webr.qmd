---
title: "Lab 2: T-Tests - WebR Practice"
subtitle: "Interactive Browser-Based Practice"
format:
  html:
    toc: true
    toc-depth: 2
    number-sections: true
    theme: cosmo
    code-fold: false
filters:
  - webr
webr:
  packages: ['readr', 'dplyr', 'ggplot2']
  show-startup-message: false
---

```{r}
#| echo: false
#| message: false
library(webexercises)
```

# Welcome

This interactive page lets you practice t-tests directly in your browser - no installation required!

::: {.callout-tip}
## How to Use This Page

1. **Run the setup code first** - this loads the data
2. **Work through the exercises** - edit code and click "Run Code"
3. **Experiment freely** - you can't break anything!
4. **Refer back to slides** - use this alongside the instructor demonstration
:::

## T-Test Adventure

Before diving into the code, explore this interactive app to build intuition about how t-tests work. Adjust sample sizes, means, and standard deviations to see how they affect your results.

<iframe src="https://oybc0p-gordon-wright.shinyapps.io/ttest_adventure/" width="100%" height="700px" frameborder="0" style="border: 1px solid #ccc; border-radius: 5px;"></iframe>

```{webr-r}
#| context: setup
#| autorun: true

# Load the test anxiety data
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)
cat("Data loaded: 80 participants, control vs intervention groups")
```

---

# Part 1: Exploring the Data

## View the Data

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

head(anxiety_data)
```

## Check the Groups

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

table(anxiety_data$group)
```

::: {.callout-note}
## Self-Check

How many participants are in each group?

`r mcq(c("20 each", answer = "40 each", "60 each", "80 each"))`
:::

---

# Part 2: One-Sample T-Test

## When to Use

Use a **one-sample t-test** when:

- You have **one sample** of data
- You want to compare to a **known population value**
- Example: Is our sample mean different from 50?

## Sample Descriptives

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

cat("Pre-test Anxiety:\n")
cat("Mean:", round(mean(anxiety_data$anxiety_pre), 2), "\n")
cat("SD:", round(sd(anxiety_data$anxiety_pre), 2), "\n")
cat("Population mean:", 50)
```

## Run the Test

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

# One-sample t-test: Is mean different from 50?
t.test(anxiety_data$anxiety_pre, mu = 50)
```

::: {.callout-note}
## Self-Check

What does `mu = 50` specify in the t.test function?

`r mcq(c("The sample mean", "The sample size", answer = "The hypothesised population mean", "The alpha level"))`
:::

---

# Part 3: Independent Samples T-Test

## When to Use

Use an **independent samples t-test** when:

- Comparing **two different groups**
- Each participant is in only one condition
- The outcome variable is continuous

## Group Descriptives

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

control <- anxiety_data$anxiety_pre[anxiety_data$group == "control"]
intervention <- anxiety_data$anxiety_pre[anxiety_data$group == "intervention"]

cat("Control: M =", round(mean(control), 2), ", SD =", round(sd(control), 2), "\n")
cat("Intervention: M =", round(mean(intervention), 2), ", SD =", round(sd(intervention), 2))
```

## Compare Groups at Pre-Test

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

# Independent samples t-test
t.test(anxiety_pre ~ group, data = anxiety_data)
```

::: {.callout-note}
## Self-Check

What does the formula `score ~ group` mean?

`r mcq(c("Score equals group", answer = "Score predicted by group", "Score minus group"))`
:::

## Compare Groups at Post-Test

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

# Compare post-test scores
t.test(anxiety_post ~ group, data = anxiety_data)
```

---

# Part 4: Paired Samples T-Test

## When to Use

Use a **paired samples t-test** when:

- Same participants measured **twice**
- Pre-post designs
- Within-subjects comparisons

## Overall Pre-Post Change

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

# Paired t-test for all participants
t.test(anxiety_data$anxiety_pre, anxiety_data$anxiety_post, paired = TRUE)
```

::: {.callout-note}
## Self-Check

What does `paired = TRUE` tell R?

`r mcq(c("Use two separate groups", answer = "Same participants measured twice", "Double the sample size"))`
:::

## Intervention Group Only

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

intervention <- anxiety_data[anxiety_data$group == "intervention", ]
t.test(intervention$anxiety_pre, intervention$anxiety_post, paired = TRUE)
```

## Control Group Only

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

control <- anxiety_data[anxiety_data$group == "control", ]
t.test(control$anxiety_pre, control$anxiety_post, paired = TRUE)
```

---

# Part 5: Effect Sizes

## Why Effect Sizes Matter

Statistical significance tells us IF there's an effect.

Effect size tells us HOW BIG the effect is.

## Cohen's d for Independent Samples

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

# Post-test comparison
control <- anxiety_data$anxiety_post[anxiety_data$group == "control"]
intervention <- anxiety_data$anxiety_post[anxiety_data$group == "intervention"]

m1 <- mean(control)
m2 <- mean(intervention)
n1 <- length(control)
n2 <- length(intervention)

pooled_sd <- sqrt(((n1-1)*var(control) + (n2-1)*var(intervention)) / (n1+n2-2))
d <- (m1 - m2) / pooled_sd

cat("Cohen's d =", round(d, 3))
```

## Interpreting Cohen's d

| d value | Interpretation |
|---------|----------------|
| 0.2 | Small |
| 0.5 | Medium |
| 0.8 | Large |

::: {.callout-note}
## Self-Check

A Cohen's d of 0.65 would be considered:

`r mcq(c("Small", answer = "Medium", "Large"))`
:::

## Cohen's d for Paired Samples

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

intervention <- anxiety_data[anxiety_data$group == "intervention", ]
diff <- intervention$anxiety_pre - intervention$anxiety_post
d <- mean(diff) / sd(diff)

cat("Cohen's d =", round(d, 3))
```

---

# Visualisation

## Boxplot by Group

```{webr-r}
library(readr)
data_url <- "https://raw.githubusercontent.com/LittleMonkeyLab/datarepo/main/test_anxiety_data.csv"
anxiety_data <- read_csv(data_url, show_col_types = FALSE)

boxplot(anxiety_post ~ group, data = anxiety_data,
        main = "Post-Test Anxiety by Group",
        xlab = "Group", ylab = "Anxiety Score",
        col = c("lightcoral", "lightgreen"))
```

---

# Knowledge Check

::: {.webex-check .webex-box}

**1. Which test compares a sample to a known population value?**

`r mcq(c(answer = "One-sample t-test", "Independent samples t-test", "Paired samples t-test"))`

**2. Which test compares the same participants at two time points?**

`r mcq(c("Independent samples t-test", answer = "Paired samples t-test", "One-way ANOVA"))`

**3. True or False: A significant p-value tells us the effect is large.**

`r torf(FALSE)`

**4. What effect size measure is commonly used with t-tests?**

`r fitb("Cohen's d", ignore_case = TRUE)`

:::

---

# Quick Reference

| Slide Part | Key Function |
|------------|--------------|
| Part 2: One-Sample | `t.test(x, mu = value)` |
| Part 3: Independent | `t.test(y ~ group, data = df)` |
| Part 4: Paired | `t.test(x, y, paired = TRUE)` |
| Part 5: Effect Size | `d = difference / pooled_sd` |

---

## Next Steps

1. Return to the activity pages for more detailed practice
2. Complete the **exercise notebook** in RStudio Server
3. Try the **follow-on exercise** for extra practice
